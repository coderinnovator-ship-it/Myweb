<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>WebForge — Instant Website Generator</title>
  <meta name="color-scheme" content="light dark">
  <style>
    :root{
      --bg:#f6f7fb; --panel:#ffffff; --muted:#6b7280; --accent:#0f62fe; --text:#071023;
      --radius:12px; --shadow:0 8px 30px rgba(11,25,50,0.06);
      font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
      --danger:#ef4444;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;background:var(--bg);color:var(--text);padding:22px; -webkit-font-smoothing:antialiased}
    .wrap{max-width:1120px;margin:0 auto;display:grid;grid-template-columns:420px 1fr;gap:20px;align-items:start}
    header{grid-column:1/-1;display:flex;gap:14px;align-items:center;margin-bottom:4px}
    .logo{background:linear-gradient(135deg,#0f62fe,#6f44ff);color:#fff;padding:10px 14px;border-radius:10px;font-weight:700}
    h1{font-size:18px;margin:0}
    p.lead{margin:2px 0 0;color:var(--muted);font-size:13px}
    .card{background:var(--panel);border-radius:var(--radius);box-shadow:var(--shadow);padding:16px}
    label{display:block;font-size:13px;color:var(--muted);margin-bottom:6px}
    .field{margin-bottom:12px}
    input[type="text"], input[type="email"], textarea, select{
      width:100%; padding:10px;border:1px solid #e6e9ef;border-radius:10px;font-size:14px;background:#fff;
      outline:none;transition:all .12s;
    }
    textarea{min-height:88px;resize:vertical}
    .row{display:flex;gap:8px}
    .col{flex:1}
    .btn{display:inline-flex;gap:8px;align-items:center;padding:10px 14px;border-radius:10px;border:0;background:var(--accent);color:#fff;font-weight:700;cursor:pointer}
    .btn.ghost{background:#fff;border:1px solid #e6e9ef;color:var(--text)}
    .btn.warn{background:var(--danger)}
    .actions{display:flex;gap:8px;flex-wrap:wrap;margin-top:10px}
    .muted{color:var(--muted);font-size:13px}
    .preview-wrap{height:78vh;display:flex;flex-direction:column;gap:12px}
    .preview{flex:1;border-radius:10px;overflow:hidden;border:1px solid #e9eef6;background:#fff}
    iframe{width:100%;height:100%;border:0;display:block}
    .note{font-size:13px;color:var(--muted)}
    .small{font-size:12px;color:var(--muted)}
    .invalid{border-color:var(--danger);box-shadow:0 0 0 3px rgba(239,68,68,0.06)}
    .errorText{color:var(--danger);font-size:12px;margin-top:6px}
    .top-controls{display:flex;gap:8px;align-items:center;justify-content:space-between}
    .status{display:inline-flex;gap:8px;align-items:center;font-weight:600}
    .status .dot{width:10px;height:10px;border-radius:99px;background:#9ca3ff;box-shadow:0 0 8px rgba(15,99,255,0.15)}
    /* red overlay if something is wrong (e.g. code would be shown) */
    .preview-error{
      position:relative;height:100%;
    }
    .preview-error .overlay{
      position:absolute;inset:0;background:linear-gradient(180deg,rgba(255,255,255,0.9),rgba(255,255,255,0.85));display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px;color:var(--danger);
      gap:12px;text-align:center;border-radius:8px;
    }
    .logo-preview{max-width:120px;max-height:80px;object-fit:contain;border-radius:8px;border:1px solid #eee;padding:6px;background:#fff}
    @media (max-width:980px){
      .wrap{grid-template-columns:1fr; padding-bottom:60px}
      .preview-wrap{height:60vh}
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <div class="logo">WebForge</div>
      <div>
        <h1>WebForge — Instant Website Generator</h1>
        <p class="lead">Enter business details (email & phone included). Click <strong>Generate</strong> to preview the website — export locked until payment.</p>
      </div>
    </header>

    <!-- LEFT: form -->
    <div class="card">
      <div class="top-controls">
        <div>
          <strong>Business details</strong>
          <div class="muted small">No country defaults — user types/selects.</div>
        </div>
        <div class="status"><span class="dot" id="statusDot"></span><span id="statusText">Preview only</span></div>
      </div>

      <form id="wfForm" autocomplete="off" style="margin-top:12px">
        <div class="field">
          <label>Business Name <span class="small muted">(required)</span></label>
          <input id="businessName" type="text" placeholder="e.g. Tailoring Shop or Connect Dev">
          <div id="err-businessName" class="errorText" style="display:none">Business name required</div>
        </div>

        <div class="row">
          <div class="col field">
            <label>Email <span class="small muted">(for contact / export)</span></label>
            <input id="email" type="email" placeholder="hello@business.com">
            <div id="err-email" class="errorText" style="display:none">Valid email required</div>
          </div>
          <div class="col field">
            <label>Phone <span class="small muted">(for contact)</span></label>
            <input id="phone" type="text" placeholder="+1 555 555 5555">
          </div>
        </div>

        <div class="field">
          <label>Country / Location</label>
          <select id="country">
            <option value="">— Select or type below —</option>
            <option value="United States">United States</option>
            <option value="China">China</option>
            <option value="United Kingdom">United Kingdom</option>
            <option value="Other">Other</option>
          </select>
          <div class="small muted">Leave blank if you'd rather enter free-form address below.</div>
        </div>

        <div class="field">
          <label>Business Address</label>
          <input id="address" type="text" placeholder="Street, City, State (optional)">
        </div>

        <div class="field">
          <label>Service Offered <span class="small muted">(short)</span></label>
          <input id="service" type="text" placeholder="e.g. Tailoring • Website • Food delivery">
        </div>

        <div class="field">
          <label>Business Description</label>
          <textarea id="description" placeholder="Short description: what you do, why you're special"></textarea>
        </div>

        <div class="row">
          <div class="col field">
            <label>Tagline / Slogan</label>
            <input id="tagline" type="text" placeholder="e.g. Oya wear latest">
          </div>
          <div class="col field">
            <label>Working Hours</label>
            <input id="hours" type="text" placeholder="Mon-Sat 8:00 - 17:00">
          </div>
        </div>

        <div class="field">
          <label>Highlights (3) — optional</label>
          <div class="row">
            <input id="h1" type="text" placeholder="Highlight 1">
            <input id="h2" type="text" placeholder="Highlight 2">
            <input id="h3" type="text" placeholder="Highlight 3">
          </div>
        </div>

        <div class="field">
          <label>Website / Social Link (optional)</label>
          <input id="social" type="text" placeholder="https://instagram.com/yourpage">
        </div>

        <div class="field">
          <label>Upload Business Logo (optional)</label>
          <input id="logo" type="file" accept="image/*">
          <div id="logoPreviewWrap" style="margin-top:8px;display:none"><img id="logoPreview" class="logo-preview" alt="logo preview"></div>
        </div>

        <div style="height:8px"></div>

        <div class="actions">
          <button id="generate" type="button" class="btn">Generate Preview</button>
          <button id="reset" type="button" class="btn ghost">Reset</button>
          <!-- export is locked; you can enable when integrating payments -->
          <button id="payExport" type="button" class="btn ghost" disabled title="Locked until payment setup">Pay to Export</button>
        </div>

        <div style="height:8px"></div>
        <div class="muted small">Design is preview-only. Exporting (download/copy) is locked until payment integration.</div>
      </form>
    </div>

    <!-- RIGHT: preview -->
    <div class="preview-wrap">
      <div class="card" style="padding:12px">
        <div style="display:flex;justify-content:space-between;align-items:center">
          <div><strong>Preview</strong> <span class="small muted">— live website output</span></div>
          <div class="small muted">Preview will open here when you click Generate.</div>
        </div>
      </div>

      <div id="previewCard" class="preview card">
        <div id="emptyPreview" style="display:flex;align-items:center;justify-content:center;height:100%;color:var(--muted)">
          <div style="text-align:center">
            <div style="font-weight:700;margin-bottom:6px">No preview yet</div>
            <div class="muted">Fill the form and click <strong>Generate Preview</strong>.</div>
          </div>
        </div>
        <!-- iframe container inserted here -->
      </div>

    </div>

  </div>

  <script>
    // Elements
    const form = document.getElementById('wfForm');
    const generateBtn = document.getElementById('generate');
    const resetBtn = document.getElementById('reset');
    const payExportBtn = document.getElementById('payExport');
    const previewCard = document.getElementById('previewCard');
    const emptyPreview = document.getElementById('emptyPreview');
    const statusDot = document.getElementById('statusDot');
    const statusText = document.getElementById('statusText');

    const fields = {
      businessName: document.getElementById('businessName'),
      email: document.getElementById('email'),
      phone: document.getElementById('phone'),
      country: document.getElementById('country'),
      address: document.getElementById('address'),
      service: document.getElementById('service'),
      description: document.getElementById('description'),
      tagline: document.getElementById('tagline'),
      hours: document.getElementById('hours'),
      h1: document.getElementById('h1'),
      h2: document.getElementById('h2'),
      h3: document.getElementById('h3'),
      social: document.getElementById('social'),
      logo: document.getElementById('logo')
    };

    const errs = {
      businessName: document.getElementById('err-businessName'),
      email: document.getElementById('err-email')
    };

    const logoPreviewWrap = document.getElementById('logoPreviewWrap');
    const logoPreview = document.getElementById('logoPreview');

    // logo handling
    let logoDataUrl = '';

    fields.logo.addEventListener('change', e=>{
      const f = e.target.files && e.target.files[0];
      if(!f){ logoPreviewWrap.style.display = 'none'; logoDataUrl = ''; return; }
      const reader = new FileReader();
      reader.onload = () => {
        logoDataUrl = reader.result;
        logoPreview.src = logoDataUrl;
        logoPreviewWrap.style.display = 'block';
      };
      reader.readAsDataURL(f);
    });

    // helpers
    function validEmail(v){
      return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v||'');
    }

    function showStatus(text, color){
      statusText.textContent = text;
      statusDot.style.background = color || '#9ca3ff';
    }

    function clearPreview(){
      previewCard.querySelectorAll('iframe, .preview-error, .preview-code').forEach(n=>n.remove());
      emptyPreview.style.display = 'flex';
      showStatus('Preview only','#9ca3ff');
    }

    function validate(){
      let ok = true;
      // businessName required
      if(!fields.businessName.value.trim()){
        fields.businessName.classList.add('invalid');
        errs.businessName.style.display = 'block';
        ok = false;
      } else {
        fields.businessName.classList.remove('invalid');
        errs.businessName.style.display = 'none';
      }
      // email optional but if present must be valid
      const emailVal = fields.email.value.trim();
      if(emailVal && !validEmail(emailVal)){
        fields.email.classList.add('invalid');
        errs.email.style.display = 'block';
        errs.email.textContent = 'Please enter a valid email';
        ok = false;
      } else {
        fields.email.classList.remove('invalid');
        errs.email.style.display = 'none';
      }
      return ok;
    }

    // build generated site HTML (safe escaping)
    function escapeHtml(s){
      return String(s||'').replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
    }

    function createServicesList(h1,h2,h3){
      const items = [];
      if(h1) items.push(escapeHtml(h1));
      if(h2) items.push(escapeHtml(h2));
      if(h3) items.push(escapeHtml(h3));
      if(items.length===0) return `<li>General Service</li><li>Contact for details</li>`;
      return items.map(i=>`<li>${i}</li>`).join('');
    }

    function buildSiteHTML(data){
      // Compose a friendly, clean single-file website HTML
      const accent = '#0f62fe';
      const hero = escapeHtml(data.tagline || data.businessName || 'Welcome');
      const desc = escapeHtml(data.description || '');
      const contactEmail = escapeHtml(data.email || '');
      const contactPhone = escapeHtml(data.phone || '');
      const address = escapeHtml(data.address || data.country || '');
      const service = escapeHtml(data.service || '');
      const highlights = createServicesList(data.h1, data.h2, data.h3);
      const social = escapeHtml(data.social || '');

      // If logoDataUrl present, include it inline
      const logoHtml = data.logoDataUrl ? `<img src="${data.logoDataUrl}" alt="logo" style="max-width:140px;border-radius:10px;border:1px solid #eee;padding:6px;background:#fff">` : '';

      // Build a small responsive page
      const page = `<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>${escapeHtml(data.businessName || 'Business')}</title>
<style>
  :root{--accent:${accent};--text:#071023}
  body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;padding:0;margin:0;background:#f4f6fb;color:var(--text)}
  header{background:var(--accent);color:#fff;padding:28px;border-bottom-left-radius:18px;border-bottom-right-radius:18px}
  .wrap{max-width:980px;margin:0 auto;padding:20px}
  h1{margin:0;font-size:28px}
  .lead{opacity:.95;margin-top:8px}
  .section{background:#fff;border-radius:12px;padding:20px;margin-top:18px;box-shadow:0 8px 30px rgba(11,25,50,0.04)}
  .grid{display:flex;gap:18px;flex-wrap:wrap}
  .col{flex:1;min-width:240px}
  ul{padding-left:18px}
  .contact a{color:var(--accent);text-decoration:none}
  footer{margin-top:28px;padding:12px;text-align:center;color:#6b7280;font-size:14px}
  @media(max-width:720px){header{padding:20px}h1{font-size:22px}.grid{flex-direction:column}}
</style>
</head>
<body>
<header>
  <div class="wrap" style="display:flex;gap:18px;align-items:center">
    <div>${logoHtml}</div>
    <div>
      <h1>${escapeHtml(data.businessName)}</h1>
      <div class="lead">${escapeHtml(service || 'We provide quality service')}</div>
    </div>
  </div>
</header>

<div class="wrap">
  <section class="section" id="about">
    <h2>${escapeHtml(hero)}</h2>
    <p class="lead">${desc}</p>
  </section>

  <section class="section" id="services">
    <h2>Highlights</h2>
    <div class="grid">
      <div class="col">
        <ul>
          ${highlights}
        </ul>
      </div>
      <div class="col">
        <p><strong>Why choose us?</strong></p>
        <p>Trusted · Value · Fast service</p>
      </div>
    </div>
  </section>

  <section class="section" id="contact">
    <h2>Contact</h2>
    <p class="contact">Phone: ${contactPhone ? `<a href="tel:${contactPhone}">${contactPhone}</a>` : '—'} · Email: ${contactEmail ? `<a href="mailto:${contactEmail}">${contactEmail}</a>` : '—'}</p>
    <p>Address: ${address || '—'}</p>
    ${social ? `<p>Website / Social: <a href="${social}" target="_blank" rel="noopener">${social}</a></p>` : ''}
  </section>

  <footer>&copy; ${new Date().getFullYear()} ${escapeHtml(data.businessName || '')} · Built with WebForge</footer>
</div>
</body>
</html>`;
      return page;
    }

    // Generate handler
    generateBtn.addEventListener('click', ()=>{
      // clear any previous iframe / errors
      previewCard.querySelectorAll('iframe, .preview-error').forEach(n=>n.remove());
      emptyPreview.style.display = 'none';

      // validate
      if(!validate()){
        showStatus('Fix required fields','var(--danger)');
        return;
      }

      // collect data
      const data = {
        businessName: fields.businessName.value.trim(),
        email: fields.email.value.trim(),
        phone: fields.phone.value.trim(),
        country: fields.country.value,
        address: fields.address.value.trim(),
        service: fields.service.value.trim(),
        description: fields.description.value.trim(),
        tagline: fields.tagline.value.trim(),
        hours: fields.hours.value.trim(),
        h1: fields.h1.value.trim(),
        h2: fields.h2.value.trim(),
        h3: fields.h3.value.trim(),
        social: fields.social.value.trim(),
        logoDataUrl: logoDataUrl
      };

      // Build HTML
      let html = '';
      try {
        html = buildSiteHTML(data);
      } catch (err) {
        // If generation fails, show red overlay with message instead of raw code
        const pe = document.createElement('div');
        pe.className = 'preview-error';
        pe.innerHTML = '<div class="overlay"><div style="font-size:18px;font-weight:800;color:var(--danger)">Generation error</div><div class="small muted">Something went wrong while generating the preview. This area prevents raw code exposure. Try again or contact support.</div></div>';
        previewCard.appendChild(pe);
        showStatus('Error','var(--danger)');
        console.error(err);
        return;
      }

      // security check: do not render if string looks like raw code dump? (we still render HTML)
      // Put the HTML into an iframe via blob to avoid it showing as downloadable code by default
      const blob = new Blob([html], {type:'text/html'});
      const url = URL.createObjectURL(blob);

      const iframe = document.createElement('iframe');
      iframe.src = url;
      // revoke after some time
      setTimeout(()=>URL.revokeObjectURL(url), 60000);

      previewCard.appendChild(iframe);
      showStatus('Preview ready','#10b981');

      // Unlock payExport only if we had payment integration; keep disabled for now
      payExportBtn.disabled = false; // <-- you can change to true to keep locked. Right now it's enabled as placeholder.
      // But we will not allow direct export until you wire real payments
      // In this template, clicking Pay to Export will show a modal placeholder.
    });

    // Reset handler
    resetBtn.addEventListener('click', ()=>{
      form.reset();
      logoDataUrl = '';
      logoPreviewWrap.style.display = 'none';
      // clear invalids
      Object.values(fields).forEach(f=>f && f.classList && f.classList.remove('invalid'));
      Object.values(errs).forEach(e=> e && (e.style.display='none'));
      clearPreview();
    });

    // Pay placeholder handler
    payExportBtn.addEventListener('click', ()=>{
      // If button is disabled, nothing happens
      if(payExportBtn.disabled) return;
      // Simulate payment + export modal placeholder
      // For now show download instructions overlay in preview
      const overlay = document.createElement('div');
      overlay.className = 'preview-error';
      overlay.innerHTML = `<div class="overlay"><div style="font-size:18px;font-weight:800;color:var(--accent)">Export locked — Payment required</div>
        <div class="small muted">To enable export (Download / Copy), connect a payment provider (Stripe/Paystack). This demo shows the preview only.</div>
        <div style="margin-top:
